<!-- Header -->
<div id="header" class="border-bottom">
  <div class="container p-3">
    <a href="/"><h2>Dokandari</h2></a>
  </div>
</div>
<!-- BreadCrumb -->
<div id="shopSignUp">
  <div class="container">
    <h4>
       <ol class="breadcrumb p-3" style="margin-left: -35px;margin-right: -13px;color: #2673bf;">
            <li class="breadcrumb-item active" aria-current="page">Personal Info</li>
            <li class="breadcrumb-item">Market Details</li>
            <li class="breadcrumb-item">Shop Details</li>
            
        </ol>
     </h4>
  </div>
</div>
<!-- !BreadCrumb -->

<!-- form -->
<div class="container mt-5">
  <div class="container">
    <h4 style="    font-size: 24.5px; color: #2673bf;">Personal Info</h4>
    <div class=""><hr>
    </div>
    <form method="post" id="personal-i">
      <div class="container">
        <div class="container my-4">
          <div class="form-group">
            <label for="name">Full Name</label>
            <input type="text" name="name" id="name" class="form-control" required>
          </div>
        <div class="form-row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="email">Email</label>
                <input type="email" name="email" id="email" class="form-control" required>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="phone">Phone No.</label>
                <input type="text" name="phone" id="phone" class="form-control" required>
              </div>
            </div>
          </div>
          <div class="form-row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="pass">Password</label>
                <input type="password" name="pass" id="pass" class="form-control" required>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="pass-c">Confirm Password</label>
                <input type="password" name="pass-c" id="pass-c" class="form-control" required>
              </div>
            </div>
          </div>
        </form>
        <div class="modal-body">
          <p>Please Select a Security Question</p>
          <select name="question" class="form-control">
            <option value="What was your first pet name?">What was your first pet name?</option>
            <option value="What was your first teacher name?">What school did you attend?</option>
            <option value="Where did your parents met?">In what city were you born?</option>
            <option value="What was my first crush name?">In what town or city was your first full time job?</option>
            <option value="What is my bestfriend name?">What is my bestfriend name?</option> 
          </select>
            <div class="form-group"> 
            <input type="text" name="answer" placeholder="Your Answer" class="form-control mt-3">
           </div>  

         </form>
            <div class="btn-next">
            <a href="/#/market" class="btn btn-primary " title="">Next</a>
          </div>
       </form>

</div>

<script>

$(document).ready(function() {
  // Login
  let formData;

  $("#market-n").click(function(event) {
    event.preventDefault();
    if (validation()) {
      formData = new FormData($("#personal-i")[0]);
      $(".personal").addClass("hide");
      $(".market").removeClass("hide");
    }
  });

  // Empty Check
  function validation() {
    flag = "false";
    if(!$("#name").val()) {
      flag = "true";
      $("#name").addClass('is-invalid');
    }
    if(!$("#phone").val()) {
      flag = "true";
      $("#phone").addClass('is-invalid');
    }
    if(!$("#email").val()) {
      flag = "true";
      $("#email").addClass('is-invalid');
    }
    else {
       const email = $("#email").val();
       if (!validateMail(email)) {
         flag = "true";
         $("#email").addClass('is-invalid');
       }
    }
    if(!$("#pass").val() && !$("#pass-c").val()) {
      flag = "true";
      $("#pass").addClass('is-invalid');
      $("#pass-c").addClass('is-invalid');
    } else {
      if ($("#pass").val() != $("#pass-c").val()) {
        flag = "true";
        $("#pass").addClass('is-invalid');
        $("#pass-c").addClass('is-invalid');
      }
    }
    if(flag == "false") {
      return true;
    } else {
      return false;
    }
  }

  // Email Validation
  function validateMail(email)
  {
    const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
  }

  // Stage 2
  $("#shop-n").click(function(event) {
    event.preventDefault();
    if (validation1()) {
      temp = new FormData($("#market-i")[0]);
      for (var pair of temp.entries()) {
        formData.append(pair[0], pair[1]);
      }
      $(".market").addClass("hide");
      $(".shop").removeClass("hide");
    }
  });

  // Change
  $("#city").change(function(){
    $("#markets").empty();
    val = $("#city").val();
    switch (val) {
      case "Lahore":
        list = "<option value=\"Hall Road\"><option value=\"Shalmi\"><option value=\"Anarkali\"><option value=\"Hafeez Center\">";
        $("#markets").append(list);
        break;
        case "Rawalpindi":
          list = "<option value=\"Raja Bazar\"><option value=\"Tench Bhatta\">";
          $("#markets").append(list);
          break;
        case "Karachi":
          list = "<option value=\"Zainab Market\"><option value=\"Empress Market\">";
          $("#markets").append(list);
          break;
        case "Peshawar":
          list = "<option value=\"Qissa Khawani Bazar\">";
          $("#markets").append(list);
          break;
        case "Kalam":
          list = "<option value=\"Kalam Bazar\">";
          $("#markets").append(list);
          break;
    }
  });

  function validation1(){
    flag = "false";
    if(!$("#city").val()) {
      flag = "true";
      $("#city").addClass('is-invalid');
    }
    if(!$("#market").val()) {
      flag = "true";
      $("#market").addClass('is-invalid');
    }
    if(!$("#shoptype").val()) {
      flag = "true";
      $("#shoptype-txt").empty();
      $("#shoptype-txt").append("Select a option");
    }
    if(flag == "false") {
      return true;
    } else {
      return false;
    }
  }

  // Stage 3
  $("#signup").click(function(event) {
    event.preventDefault();
    if (validation2()) {
      temp = new FormData($("#shop-i")[0]);
      for (var pair of temp.entries()) {
        formData.append(pair[0], pair[1]);
      }
      $.ajax({
        type: 'POST',
        url: '/etc/php/shop/signup',
        processData: false,
        contentType: false,
        data: formData,
        success: function(response) {
          if (response == "success") {
            window.location.replace("/shop/login");
          } else {alert(response)}
        }
      });
    }
  });

  function validation2(){
    flag = "false";
    if(!$("#upload").val()) {
      flag = "true";
      $("#file").empty();
      $("#file").append("Please Upload a image");
    }
    if(!$("#shopname").val()) {
      flag = "true";
      $("#shopname").addClass('is-invalid');
    }
    if(!$("#shopaddr").val()) {
      flag = "true";
      $("#shopaddr").addClass('is-invalid');
    }
    if(!$("#opentime").val()) {
      flag = "true";
      $("#opentime").addClass('is-invalid');
    }
    if(!$("#closetime").val()) {
      flag = "true";
      $("#closetime").addClass('is-invalid');
    }
    if(flag == "false") {
      return true;
    } else {
      return false;
    }
  }

});


 </script>